# OTT ìŠ¤íŠ¸ë¦¬ë° ì„œë²„ í”„ë¡œì íŠ¸ ì‹œì‘ ê°€ì´ë“œ

## ğŸ‰ í”„ë¡œì íŠ¸ ìƒì„± ì™„ë£Œ!

ì „ì²´ êµ¬ì¡°ì™€ ì½”ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

## ğŸ“ ìƒì„±ëœ íŒŒì¼ êµ¬ì¡°

```
ott/
â”œâ”€â”€ ğŸ“„ README.md                    # í”„ë¡œì íŠ¸ ë¬¸ì„œ
â”œâ”€â”€ ğŸ“„ .gitignore                   # Git ì œì™¸ íŒŒì¼
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ OTT-Spec.md                # í”„ë¡œì íŠ¸ ëª…ì„¸ì„œ
â”‚   â””â”€â”€ PROGRESS.md                # ì§„í–‰ ìƒí™©
â”œâ”€â”€ server-c/                      # C ì„œë²„
â”‚   â”œâ”€â”€ Makefile                   # ë¹Œë“œ íŒŒì¼
â”‚   â”œâ”€â”€ config.ini                 # ì„¤ì • íŒŒì¼
â”‚   â”œâ”€â”€ include/                   # í—¤ë” (11ê°œ)
â”‚   â”‚   â”œâ”€â”€ config.h
â”‚   â”‚   â”œâ”€â”€ types.h
â”‚   â”‚   â”œâ”€â”€ db.h
â”‚   â”‚   â”œâ”€â”€ auth.h
â”‚   â”‚   â”œâ”€â”€ streaming.h
â”‚   â”‚   â”œâ”€â”€ thumbnail.h
â”‚   â”‚   â”œâ”€â”€ uuid.h
â”‚   â”‚   â”œâ”€â”€ json_helper.h
â”‚   â”‚   â”œâ”€â”€ http_handler.h
â”‚   â”‚   â”œâ”€â”€ thread_pool.h
â”‚   â”‚   â””â”€â”€ logger.h
â”‚   â”œâ”€â”€ src/                       # êµ¬í˜„ (10ê°œ)
â”‚   â”‚   â”œâ”€â”€ main.c
â”‚   â”‚   â”œâ”€â”€ db.c
â”‚   â”‚   â”œâ”€â”€ auth.c
â”‚   â”‚   â”œâ”€â”€ streaming.c
â”‚   â”‚   â”œâ”€â”€ thumbnail.c
â”‚   â”‚   â”œâ”€â”€ uuid.c
â”‚   â”‚   â”œâ”€â”€ json_helper.c
â”‚   â”‚   â”œâ”€â”€ http_handler.c
â”‚   â”‚   â”œâ”€â”€ thread_pool.c
â”‚   â”‚   â””â”€â”€ logger.c
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ V1__init.sql          # DB ìŠ¤í‚¤ë§ˆ
â”‚   â””â”€â”€ third_party/              # (ë¹Œë“œ ì‹œ ìƒì„±)
â”œâ”€â”€ web/                          # ì›¹ UI
â”‚   â”œâ”€â”€ index.html                # ë¡œê·¸ì¸
â”‚   â”œâ”€â”€ videos.html               # ëª©ë¡
â”‚   â”œâ”€â”€ player.html               # ì¬ìƒ
â”‚   â””â”€â”€ assets/
â”‚       â”œâ”€â”€ styles.css
â”‚       â””â”€â”€ app.js
â”œâ”€â”€ media/                        # ë¯¸ë””ì–´ ì €ì¥ì†Œ
â”‚   â”œâ”€â”€ videos/
â”‚   â””â”€â”€ thumbnails/
â””â”€â”€ scripts/                      # ê´€ë¦¬ ìŠ¤í¬ë¦½íŠ¸
    â”œâ”€â”€ setup.sh                  # ì„¤ì •
    â”œâ”€â”€ create_user.sh            # ì‚¬ìš©ì ìƒì„±
    â””â”€â”€ add_video.sh              # ë¹„ë””ì˜¤ ì¶”ê°€
```

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

### 1ë‹¨ê³„: ì‹œìŠ¤í…œ ì˜ì¡´ì„± ì„¤ì¹˜

```bash
# macOS Homebrew í•„ìš”
brew install sqlite3 libsodium ffmpeg
```

### 2ë‹¨ê³„: í”„ë¡œì íŠ¸ ì„¤ì •

```bash
cd /Users/jht/Desktop/Projects/NetworkPrograming/ott

# ì„¤ì • ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ (ê¶Œì¥)
./scripts/setup.sh

# ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ:
cd server-c
make deps        # CivetWeb, cJSON ë‹¤ìš´ë¡œë“œ
make db-init     # ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
```

### 3ë‹¨ê³„: ë¹Œë“œ

```bash
cd server-c
make all
```

**ì˜ˆìƒ ê²°ê³¼**: `ott_server` ì‹¤í–‰ íŒŒì¼ ìƒì„±

### 4ë‹¨ê³„: ì‚¬ìš©ì ìƒì„±

```bash
cd ..
./scripts/create_user.sh test password123 'í…ŒìŠ¤íŠ¸ì‚¬ìš©ì'
```

### 5ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë¹„ë””ì˜¤ ì¶”ê°€

```bash
# MP4 íŒŒì¼ì´ ìˆëŠ” ê²½ìš°
./scripts/add_video.sh /path/to/video.mp4 'í…ŒìŠ¤íŠ¸ì˜ìƒ' 'í…ŒìŠ¤íŠ¸ ì„¤ëª…'

# ì—†ëŠ” ê²½ìš°: ìƒ˜í”Œ ë¹„ë””ì˜¤ ë‹¤ìš´ë¡œë“œ
# (ì˜ˆ: Big Buck Bunny)
curl -o ~/Downloads/test.mp4 http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4
./scripts/add_video.sh ~/Downloads/test.mp4 'Big Buck Bunny' 'ìƒ˜í”Œ ì• ë‹ˆë©”ì´ì…˜'
```

### 6ë‹¨ê³„: ì„œë²„ ì‹¤í–‰

```bash
cd server-c
make run

# ë˜ëŠ” ì§ì ‘:
./ott_server
```

**í™•ì¸**:
- `http://localhost:8080` ì ‘ì†
- ì½˜ì†”ì— "Server is ready!" ë©”ì‹œì§€ í‘œì‹œ

### 7ë‹¨ê³„: ì›¹ UI í…ŒìŠ¤íŠ¸

1. ë¸Œë¼ìš°ì €ì—ì„œ `http://localhost:8080` ì ‘ì†
2. ìƒì„±í•œ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ (test / password123)
3. ë™ì˜ìƒ ëª©ë¡ì—ì„œ ë¹„ë””ì˜¤ ì„ íƒ
4. ì¬ìƒ ë° ì´ì–´ë³´ê¸° ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ë¹Œë“œ ì—ëŸ¬ ë°œìƒ ì‹œ

1. **CivetWeb/cJSON ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨**
   ```bash
   cd server-c
   rm -rf third_party
   make deps
   ```

2. **ì»´íŒŒì¼ ì—ëŸ¬**
   ```bash
   # ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸ í›„ ì•Œë ¤ì£¼ì„¸ìš”
   make clean
   make all
   ```

3. **ë§ì»¤ ì—ëŸ¬ (libsodium)**
   ```bash
   brew reinstall libsodium
   ```

### ëŸ°íƒ€ì„ ì—ëŸ¬

1. **í¬íŠ¸ ì´ë¯¸ ì‚¬ìš© ì¤‘**
   ```bash
   # ë‹¤ë¥¸ í¬íŠ¸ ì‚¬ìš© (config.h ìˆ˜ì •)
   # #define SERVER_PORT "8080" â†’ "8081"
   ```

2. **ë°ì´í„°ë² ì´ìŠ¤ ì ê¸ˆ**
   ```bash
   cd server-c
   make db-reset
   ```

3. **FFmpeg ì—†ìŒ**
   ```bash
   brew install ffmpeg
   ```

## âœ… ê¸°ëŠ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸

í”„ë¡œì íŠ¸ê°€ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸:

- [ ] ì„œë²„ ì‹œì‘ë¨
- [ ] ë¡œê·¸ì¸ ì„±ê³µ
- [ ] ë™ì˜ìƒ ëª©ë¡ í‘œì‹œ
- [ ] ë¹„ë””ì˜¤ ì¬ìƒ ì‹œì‘
- [ ] Range ìš”ì²­ ë™ì‘ (ë¸Œë¼ìš°ì € seekbar ì´ë™)
- [ ] ì´ì–´ë³´ê¸° ëª¨ë‹¬ í‘œì‹œ
- [ ] ì‹œì²­ ìœ„ì¹˜ ì €ì¥/ë³µì›
- [ ] ì¸ë„¤ì¼ í‘œì‹œ
- [ ] ê²€ìƒ‰ ê¸°ëŠ¥
- [ ] 2ëª… ì´ìƒ ë™ì‹œ ì¬ìƒ

## ğŸ“Š ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

### Range ìš”ì²­ í…ŒìŠ¤íŠ¸

```bash
# ì „ì²´ ë‹¤ìš´ë¡œë“œ
curl -u test:password123 http://localhost:8080/api/videos/<VIDEO_ID>/stream -o full.mp4

# ë¶€ë¶„ ë‹¤ìš´ë¡œë“œ
curl -u test:password123 -H "Range: bytes=0-1000000" http://localhost:8080/api/videos/<VIDEO_ID>/stream -o partial.mp4

# ì‹œì‘ ìœ„ì¹˜ (60ì´ˆë¶€í„°)
curl -u test:password123 "http://localhost:8080/api/videos/<VIDEO_ID>/stream?start=60" -o from60.mp4
```

### ë™ì‹œì„± í…ŒìŠ¤íŠ¸

í„°ë¯¸ë„ 2ê°œë¥¼ ì—´ê³  ë™ì‹œì— ì‹¤í–‰:

```bash
# í„°ë¯¸ë„ 1
curl -u test:password123 http://localhost:8080/api/videos/<ID>/stream -o test1.mp4

# í„°ë¯¸ë„ 2 (ë™ì‹œì—)
curl -u test:password123 http://localhost:8080/api/videos/<ID>/stream -o test2.mp4
```

ì„œë²„ ë¡œê·¸ì—ì„œ ë™ì‹œ ì²˜ë¦¬ í™•ì¸

## ğŸ“ ë‹¤ìŒ ì‘ì—…

1. **ìš°ì„ ìˆœìœ„ 1**: ë¹Œë“œ ë° ê¸°ë³¸ ë™ì‘ í™•ì¸
2. **ìš°ì„ ìˆœìœ„ 2**: ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ ë° ë²„ê·¸ ìˆ˜ì •
3. **ìš°ì„ ìˆœìœ„ 3**: ì„±ëŠ¥ ìµœì í™”
4. **ìš°ì„ ìˆœìœ„ 4**: ë¬¸ì„œ ë³´ì™„ (ë³´ê³ ì„œ ì‘ì„±)

## ğŸ¯ í”„ë¡œì íŠ¸ ëª©í‘œ (ëª…ì„¸ì„œ ê¸°ì¤€)

### í•„ìˆ˜ ê¸°ëŠ¥ êµ¬í˜„ ìƒíƒœ

âœ… ì›¹ ë¸Œë¼ìš°ì € ë™ì˜ìƒ ì‹œì²­  
âœ… ë©€í‹°ìœ ì € HTTP Range 206 ìŠ¤íŠ¸ë¦¬ë°  
âœ… ì´ì–´ë³´ê¸° (ì‹œì²­ ìœ„ì¹˜ ì €ì¥/ë³µì›)  
âœ… ì‹œì‘ ìœ„ì¹˜ ì¬ìƒ (?start=ì´ˆ)  
âœ… ì¸ë„¤ì¼ ìë™ ì¶”ì¶œ (FFmpeg)  
âœ… HTTP Basic ì¸ì¦  
âœ… ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ (libsodium)  
âœ… ìŠ¤ë ˆë“œ í’€ ë™ì‹œì„±  
ğŸ”² ìµœì†Œ 2ëª… ë™ì‹œ ìŠ¤íŠ¸ë¦¬ë° í…ŒìŠ¤íŠ¸ í•„ìš”  

### ì‚°ì¶œë¬¼ ìƒíƒœ

âœ… API ëª…ì„¸ì„œ (OTT-Spec.md)  
âœ… ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (V1__init.sql)  
âœ… ê¸°ìˆ  ìŠ¤íƒ/ì•„í‚¤í…ì²˜ ì„¤ëª… (README.md)  
âœ… Makefile  
âœ… ì›¹ UI (index.html, videos.html, player.html)  
ğŸ”² í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤/ìŠ¤í¬ë¦°ìƒ· (ì§„í–‰ í•„ìš”)  
ğŸ”² ë³´ê³ ì„œ ì‘ì„± (ì§„í–‰ í•„ìš”)  

## ğŸ’¡ íŒ

1. **ê°œë°œ ì¤‘ ë¡œê·¸ í™•ì¸**
   - ì„œë²„ ì½˜ì†”ì—ì„œ ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§
   - `LOG_DEBUG` ë ˆë²¨ë¡œ ë³€ê²½í•˜ë©´ ë” ìƒì„¸í•œ ì •ë³´

2. **ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬**
   - Network íƒ­ì—ì„œ Range ìš”ì²­ í™•ì¸
   - Consoleì—ì„œ JavaScript ì—ëŸ¬ í™•ì¸

3. **ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸**
   ```bash
   cd server-c
   sqlite3 app.db
   .tables
   SELECT * FROM users;
   SELECT * FROM videos;
   .quit
   ```

## ğŸ“ ë„ì›€ì´ í•„ìš”í•˜ë©´

ì§„í–‰ ì¤‘ ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ê²°ì •ì´ í•„ìš”í•œ ì‚¬í•­ì´ ìˆìœ¼ë©´ ì–¸ì œë“ ì§€ ë¬¼ì–´ë³´ì„¸ìš”!

**í˜„ì¬ ìœ„ì¹˜**: í”„ë¡œì íŠ¸ êµ¬ì¡° ìƒì„± ì™„ë£Œ  
**ë‹¤ìŒ ë‹¨ê³„**: ë¹Œë“œ ë° í…ŒìŠ¤íŠ¸ ì‹œì‘
